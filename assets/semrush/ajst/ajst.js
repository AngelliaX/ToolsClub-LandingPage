"use strict";(()=>{function c(a){return a===null||typeof a!="object"||"Symbol"in window&&typeof Symbol.toStringTag=="symbol"&&Symbol.toStringTag in a&&a[Symbol.toStringTag]==="Object"?!1:Object.prototype.toString.call(a)==="[object Object]"}function y(a){try{return JSON.parse(JSON.stringify(a))}catch{return}}function v(a){return Array.isArray(a)?a.every(e=>typeof e[0]=="string"&&(Object.prototype.toString.call(e[1])==="[object Arguments]"||Array.isArray(e[1]))):!1}function k(a){return typeof a!="string"?!1:/^GTM-[A-Z0-9]{6,}$/.test(a)}function w(a){window[a]instanceof Array||(window[a]=[])}function x(a,e){let t=[a],r=[];for(;t.length>0;){let n=t.pop(),i=n.querySelectorAll(e);i.length>0&&r.push(i);for(let s of n.querySelectorAll("iframe"))s.contentDocument&&t.push(s.contentDocument)}return r}function q(a){let e=a.split(".");for(let t of e)if(t.length===0||!/^[a-zA-Z0-9][a-zA-Z0-9_-]*$/.test(t)||/[-_]$/.test(t)||/[-_]{2}/.test(t))return!1;return!0}function f(a){typeof self.reportError=="function"?self.reportError(a):setTimeout(function(){throw a})}function o(a){return[{message:a}]}var p=class{constructor(e,t){this.rules=e,this.domManager=t}validateEvent(e,t){if(e.length===0)return o("Event name must not be empty");let r=this.rules.events[e];if(r===void 0)return o(`Event name "${e}" is not found in allowed events`);let n=r.container_name,i=[];typeof n=="string"&&(i=this.validateContainerPayload(t,n,r));let s=this.getPayloadWithoutContainer(t,n),m=this.validateTopLevelPayload(s,r);return[...i,...m]}validatePayload(e){return Object.entries(e).flatMap(([t,r])=>this.validatePayloadProperty(t,r))}validateContainerPayload(e,t,r){let n=e[t];if(!c(n))return o(`Missed expected container with name "${t}" in event payload`);let i=Object.keys(n),s=(r.container_required_properties??[]).reduce((u,b)=>i.includes(b)?u:u.concat(o(`Required property ${b} is not defined in container "${t}" payload`)),[]),m=this.validatePayload(n);return[...s,...m]}validateTopLevelPayload(e,t){let r=Object.keys(e);for(let n of t.required_properties??[])if(!r.includes(n))return o(`Required property key "${n}" is not defined in event payload`);return this.validatePayload(e)}getPayloadWithoutContainer(e,t){if(typeof t!="string")return e;let r={};for(let[n,i]of Object.entries(e))n!==t&&(r[n]=i);return r}validatePayloadProperty(e,t){if(e.length===0)return o("Received a payload with an empty property key");let r=this.rules.properties[e];if(r===void 0)return o(`Property key "${e}" is not found in allowed properties`);switch(r.type){case"string":return this.validateString(e,t,r);case"choice":return this.validateChoice(e,t,r);case"boolean":return this.validateBoolean(e,t);case"number":return this.validateNumber(e,t);case"array":return this.validateArray(e,t,r);default:return o(`Property "${e}" has unknown type "${r.type}". Please check your rules`)}}validateString(e,t,r){if(typeof t!="string")return o(`Property "${e}" must be string, but got "${typeof t}"`);if(r.min_length!==void 0&&t.length<r.min_length)return o(`Property "${e}" must be at least ${r.min_length} characters long`);if(r.max_length!==void 0&&t.length>r.max_length)return o(`Property "${e}" must be no longer than ${r.max_length} characters long`);if(r.check_format===!0&&!q(t))return o(`Property value "${t}" for key "${e}" have not passed format check`);if(typeof r.check_attribute=="string"){let n=r.check_attribute,i=x(this.domManager,`[${n}="${t}"]`);if(i.every(s=>s.length===0))return o(`Document does not contain element with attribute "${n}" and value "${t}", but it is required to be present in the document`);if(r.check_attribute_unique_id===!0&&i.some(s=>s.length>1))return o(`Document contains more than one element with attribute "${n}" and value "${t}", but it is required to be unique in the document`)}return[]}validateChoice(e,t,r){return r.choice_values.includes(t)?[]:o(`Property "${e}" must be one of [${r.choice_values.join(", ")}], got "${t}"`)}validateBoolean(e,t){return typeof t!="boolean"?o(`Property "${e}" must be boolean, got "${typeof t}"`):[]}validateNumber(e,t){return typeof t!="number"||!isFinite(t)?o(`Property "${e}" must be a finite number, but got "${typeof t}"`):[]}validateArray(e,t,r){if(!Array.isArray(t))return o(`Property "${e}" must be an array, got "${typeof t}"`);for(let n of t){if(!c(n))return o(`Property "${e}" must be an array of objects, got "${typeof n}" in array`);let i=Object.keys(n);for(let s of r.array_required_properties??[])if(!i.includes(s))return o(`Required property key "${s}" is not defined in array item of property "${e}"`)}return[]}};var l=class extends Error{constructor(e){super(e),this.name="AnalyticsError"}},_=class extends l{constructor(e){super(e),this.name="AnalyticsInitializationError"}},d=class extends l{constructor(t,r){super(`method call error: ${t}(...) ${r}`);this.name="AnalyticsMethodCallError",this.methodName=t}},h=class extends l{constructor(t){let r=t.map(n=>n.message).map((n,i)=>`${i+1}. ${n}`).join(`
`);super(r);this.name="AnalyticsValidationAggregateError",this.errors=t}};var g=class{constructor(e){this.eventPayloadDefaults=new Map;this.options=Object.freeze({validationRules:e.validationRules,dataLayerName:"dataLayer"}),this.validator=new p(this.options.validationRules,document)}get facade(){return this._facade||(this._facade=this.createFacade()),this._facade}createFacade(){return Object.seal({setDefaults:(e,t)=>this.setDefaults(e,t),deleteDefaults:e=>this.deleteDefaults(e),track:(e,t)=>this.track(e,t)})}throwValidationErrors(e){f(new h(e))}throwMethodCallError(e,t){f(new d(e,t))}setDefaults(e,t){if(t=y(t),typeof e!="string"){this.throwMethodCallError("setDefaults",`the key must be string but got "${typeof e}"`);return}let r=this.validator.validatePayload({[e]:t});if(r.length>0){this.throwValidationErrors(r);return}this.eventPayloadDefaults.set(e,t),this.pushInternalEvent({[e]:t,"ajst.js.defaults":"set"})}deleteDefaults(e){if(typeof e!="string"){this.throwMethodCallError("deleteDefaults",`the key must be string but got "${typeof e}"`);return}this.eventPayloadDefaults.delete(e),this.pushInternalEvent({[e]:null,"ajst.js.defaults":"delete"})}track(e,t){if(typeof e!="string"){this.throwMethodCallError("track",`the event name must be string but got "${typeof e}"`);return}let r;if(typeof t>"u")r={};else if(c(t))r=y(t)||{};else{this.throwMethodCallError("track",`event payload must be literal object, got "${typeof t}"`);return}let n={...Object.fromEntries(this.eventPayloadDefaults),...r},i=this.validator.validateEvent(e,n);if(i.length>0){this.throwValidationErrors(i);return}let s={...Object.keys(n).reduce((m,u)=>(m[u]=null,m),{}),...Object.fromEntries(this.eventPayloadDefaults)};this.pushToDataLayer({...n,event:e,initiator:"ajst.js"}),this.pushToDataLayer({...s,event:null,initiator:null})}pushToDataLayer(e){let t=window[this.options.dataLayerName];if(!Array.isArray(t)){this.throwMethodCallError("pushToDataLayer","could not find valid dataLayer object on the page");return}t.push({...e,_clear:!0})}pushInternalEvent(e){this.pushToDataLayer({...e})}};function E(a,e="dataLayer"){let t=window[e];if(!Array.isArray(t))throw new Error("could not find valid dataLayer object on the page");if(!k(a))throw new Error("ajst.js: trying to inject GTM with invalid containerId");t.push({"gtm.start":new Date().getTime(),event:"gtm.js"});{let r=document.getElementsByTagName("script")[0],n=document.createElement("script"),i=e!="dataLayer"?"&l="+e:"";n.async=!0,n.src="https://www.googletagmanager.com/gtm.js?id="+a+i,r.parentNode.insertBefore(n,r)}}function j(a,e){function t(r,n){throw new _(`Invalid ${r}(...) arguments: ${JSON.stringify(n)}`)}try{for(let[r,n]of e)switch(r){case"track":(n.length===0||n.length>2)&&t("track",n),a.track(n[0],n[1]);break;case"setDefaults":n.length!==2&&t("setDefaults",n),a.setDefaults(n[0],n[1]);break;case"deleteDefaults":n.length!==1&&t("deleteDefaults",n),a.deleteDefaults(n[0]);break;default:throw new _(`Unknown pending analytics action: ${r}`)}}catch(r){throw new _(`Error while replaying pending analytics: ${r instanceof Error?r.message:JSON.stringify(r)}`)}}var P={events:{activate:{required_properties:["semrush_product_name","semrush_team"]},add_payment_info:{container_name:"ecommerce",container_required_properties:["currency","items","value"],required_properties:["semrush_product_name","semrush_team"]},add_shipping_info:{container_name:"ecommerce",container_required_properties:["currency","items","value"],required_properties:["semrush_product_name","semrush_team"]},add_to_cart:{container_name:"ecommerce",container_required_properties:["currency","items","value"],required_properties:["semrush_product_name","semrush_team"]},add_to_wishlist:{container_name:"ecommerce",container_required_properties:["currency","items","value"],required_properties:["semrush_product_name","semrush_team"]},begin_checkout:{container_name:"ecommerce",container_required_properties:["currency","items","value"],required_properties:["semrush_product_name","semrush_team"]},bounce:{required_properties:["semrush_product_name","semrush_team"]},change:{required_properties:["semrush_product_name","semrush_team"]},click:{required_properties:["semrush_product_name","semrush_team"]},close:{required_properties:["semrush_product_name","semrush_team"]},create:{required_properties:["semrush_product_name","semrush_team"]},deactivate:{required_properties:["semrush_product_name","semrush_team"]},deliver:{required_properties:["semrush_product_name","semrush_team"]},earn_virtual_currency:{required_properties:["semrush_product_name","semrush_team","value","virtual_currency_name"]},edit:{required_properties:["semrush_product_name","semrush_team"]},form_reset:{required_properties:["semrush_product_name","semrush_team"]},form_start:{required_properties:["form_name","semrush_product_name","semrush_team"]},form_submit:{required_properties:["form_name","form_submit_text","semrush_product_name","semrush_team"]},generate_lead:{required_properties:["semrush_product_name","semrush_team"]},grant_access:{required_properties:["semrush_product_name","semrush_team"]},hide:{required_properties:["semrush_product_name","semrush_team"]},hover:{required_properties:["semrush_product_name","semrush_team"]},input:{required_properties:["semrush_product_name","semrush_team"]},join_group:{required_properties:["semrush_product_name","semrush_team"]},login:{required_properties:["method","semrush_product_name","semrush_team"]},open:{required_properties:["semrush_product_name","semrush_team"]},purchase:{container_name:"ecommerce",container_required_properties:["currency","items","transaction_id","value"],required_properties:["semrush_product_name","semrush_team"]},refund:{container_name:"ecommerce",container_required_properties:["currency","items","transaction_id","value"],required_properties:["semrush_product_name","semrush_team"]},reject:{required_properties:["semrush_product_name","semrush_team"]},remove_from_cart:{container_name:"ecommerce",container_required_properties:["currency","items","value"],required_properties:["semrush_product_name","semrush_team"]},revoke_access:{required_properties:["semrush_product_name","semrush_team"]},search:{required_properties:["search_term","semrush_product_name","semrush_team"]},select_content:{required_properties:["semrush_product_name","semrush_team"]},select_item:{container_name:"ecommerce",container_required_properties:["items"],required_properties:["semrush_product_name","semrush_team"]},select_promotion:{container_name:"ecommerce",container_required_properties:["items"],required_properties:["semrush_product_name","semrush_team"]},send:{required_properties:["semrush_product_name","semrush_team"]},share:{required_properties:["semrush_product_name","semrush_team"]},show:{required_properties:["semrush_product_name","semrush_team"]},sign_up:{required_properties:["method","semrush_product_name","semrush_team"]},sm_error:{required_properties:["semrush_product_name","semrush_team"]},spend_virtual_currency:{required_properties:["semrush_product_name","semrush_team","value","virtual_currency_name"]},tutorial_begin:{required_properties:["semrush_product_name","semrush_team"]},tutorial_complete:{required_properties:["semrush_product_name","semrush_team"]},unsubscribe:{required_properties:["semrush_product_name","semrush_team"]},upload:{required_properties:["semrush_product_name","semrush_team"]},view_cart:{container_name:"ecommerce",container_required_properties:["currency","items","value"],required_properties:["semrush_product_name","semrush_team"]},view_item:{container_name:"ecommerce",container_required_properties:["currency","items","value"],required_properties:["semrush_product_name","semrush_team"]},view_item_list:{container_name:"ecommerce",container_required_properties:["items"],required_properties:["semrush_product_name","semrush_team"]},view_promotion:{container_name:"ecommerce",container_required_properties:["items"],required_properties:["semrush_product_name","semrush_team"]}},properties:{_clear:{type:"boolean"},addon_type:{check_format:!0,max_length:27,min_length:1,type:"string"},affiliation:{check_format:!0,max_length:100,min_length:1,type:"string"},app_name:{check_format:!0,max_length:100,min_length:1,type:"string"},corporate_type:{choice_values:["owner","user"],type:"choice"},coupon:{check_format:!0,max_length:100,min_length:1,type:"string"},creative_name:{check_format:!0,max_length:100,min_length:1,type:"string"},creative_slot:{check_format:!0,max_length:100,min_length:1,type:"string"},currency:{check_format:!0,max_length:100,min_length:1,type:"string"},discount:{type:"number"},event_source:{check_format:!0,max_length:100,min_length:1,type:"string"},file_extension:{check_format:!0,max_length:100,min_length:1,type:"string"},file_name:{check_format:!0,max_length:100,min_length:1,type:"string"},form_destination:{check_format:!0,max_length:100,min_length:1,type:"string"},form_id:{check_format:!0,max_length:100,min_length:1,type:"string"},form_name:{check_format:!0,max_length:100,min_length:1,type:"string"},form_submit_text:{max_length:100,min_length:1,type:"string"},group_id:{check_format:!0,max_length:100,min_length:1,type:"string"},index:{type:"number"},item_brand:{check_format:!0,max_length:100,min_length:1,type:"string"},item_category:{check_format:!0,max_length:100,min_length:1,type:"string"},item_category2:{check_format:!0,max_length:100,min_length:1,type:"string"},item_category3:{check_format:!0,max_length:100,min_length:1,type:"string"},item_category4:{check_format:!0,max_length:100,min_length:1,type:"string"},item_category5:{check_format:!0,max_length:100,min_length:1,type:"string"},item_id:{check_format:!0,max_length:100,min_length:1,type:"string"},item_label:{check_format:!0,max_length:100,min_length:1,type:"string"},item_list_id:{check_format:!0,max_length:100,min_length:1,type:"string"},item_list_name:{check_format:!0,max_length:100,min_length:1,type:"string"},item_location:{check_attribute:"data-path",check_format:!0,max_length:100,min_length:1,type:"string"},item_name:{check_format:!0,max_length:100,min_length:1,type:"string"},item_variant:{check_format:!0,max_length:100,min_length:1,type:"string"},items:{array_required_properties:["item_name"],type:"array"},limit_name:{check_format:!0,max_length:100,min_length:1,type:"string"},link_classes:{max_length:100,min_length:1,type:"string"},link_domain:{max_length:100,min_length:1,type:"string"},link_id:{max_length:100,min_length:1,type:"string"},link_text:{max_length:100,min_length:1,type:"string"},link_url:{max_length:100,min_length:1,type:"string"},location_id:{check_format:!0,max_length:100,min_length:1,type:"string"},method:{check_format:!0,max_length:100,min_length:1,type:"string"},outbound:{type:"boolean"},percent_scrolled:{type:"number"},price:{type:"number"},promotion_id:{check_format:!0,max_length:100,min_length:1,type:"string"},promotion_name:{check_format:!0,max_length:100,min_length:1,type:"string"},quantity:{type:"number"},search_term:{max_length:100,min_length:1,type:"string"},semrush_product_name:{choice_values:["about","academy","accounts","act","ads_history","ads_launch_assistant","advertising_research","agency_directory","agency_profile","agk_landing","aismpg","akm","akw","alertmanager","alp","alqc","amazon_acos_calc","amazon_api_gateway","amazon_ci","amazon_ppc_optimizer","api_balancer","app_center","apr","ast","ati","atm","authentication","backlink_audit","backlink_gap","backlinks_analytics","backup_service","berush","berush_pm","billing_admin","billing_currencies","billing_platform","billing_processing","billing_seamless_purchase","billing_service","billing_subscriptions","billing_tax","billing_widgets","blog","bot","brand_monitoring","bucket_service","cancellation_form","career","cerberus","challenger","changemn","client_portal","competitors_lists","content_audit","content_marketing_landing","content_marketing_platform","content_paywall","coub","crm","custom_api","custom_integrations","custom_serp_api","dag_auth","databus","developer_app_center","domain_analytics_api","domain_demographics","domain_overview","drt_monitoring","dwh","ebooks","ecommerce_booster","enterprise","external_balancer","external_network","features","feedback","free_tools","front_balancer","g_local_connector","gap","gcp","gcp_monitoring","gkt","globalmarketingday","golden_project","goodcontent_hub","grafana","haimdall","help_menu","hermes","ikr","impact_integration","impacthero","intercom","intergalactic","internal_balancer","internal_ingress","keyword_analytics_api","keyword_gap","keyword_intent","keyword_magic_tool","keyword_manager","keyword_overview","knowledge_base","lead_finder","lead_generation_tool","lfa","limit","link_building_tool","listing_quality_check","listings_management","local_unit_blog","lp_backend","mail_delivery_system","main_page","map_rank_tracker","market_explorer","marketing_calendar","marketing_landing_page","marketing_platform","marketo_landing_page","marketplace","monolith","multi_invite_widget","multilogin_page","my_reports","nanoprojects","network","news","nlp_models","nlp_proxy","notes","oauth","observability","ocob","on_page_seo_checker","one2target","open_trends","organic_research","oti","page_engine","partners_landing","persona_builder","pla_research","position_tracking","post_tracking","power_pages","ppc_keyword_tool","prices","product_feed_hc","profile","projects_service","prometheus_lts","prometheus_rules","promxy","prowly","prowly_integrations","public_ranks_api","pulse","purr","pusheen","quazar","query","related_service","release_checker","reporting_collector","rhythm","rocket","salesforce_integration","search_api","search_engine_poc","sec_dev_ingress","secure","sellerly_admin","sellerly_blog","sellerly_info_pages","sempay","semrush2","semrush2_config","semrush_admin","semrush_com_db","semrush_developer","semrush_local_premium","semrush_rank","sensor","seo_content_template","seo_dashboard","seo_self_taught","seo_writing_assistant","seoquake","serp","sharing","site","site_audit","smr_sh","smt_inbox","social_media_ads","social_media_analytic","social_media_poster","social_media_tool","social_media_tracker","splitsignal","spyon","srm","sso","stargate","stargate_internal","stats","subscription_info","support_tickets","ta_reports_gate","tenders_hub","third_party","title_generator","topic_research","traffic_analytics","traffic_analytics_api","trebuchet","udh","universal_search","uptime","uptime_proxy","url_manager","user_backend_service","user_management","uss_service","vault","victoria_metrics","wallarm_ingress","webinars"],type:"choice"},semrush_team:{choice_values:["amber_team","amber_team","asteria_team","automation_team","avocado_team","black_team","blue_team","cherry_team","chili_team","cobalt_team","coffee_team","core_team","cream_team","crimson_team","custom_solutions_team","data_lab_team","dca_team","deep_purple_team","ds_team","ect_team","force_team","frozen_team","ginger_team","gkt_team","graphite_team","iris_team","ivory_team","khaki_team","kind_team","light_team","lion_team","mango_team","marketing_design_team","marketing_technology_team","maroon_team","melon_team","mint_team","navy_team","neon_team","ninja_team","onyx_team","orange_team","papyrus_team","protos_team","prowly_team","pulse_team","raspberry_team","red_team","rhythm_team","ruby_team","samurai_team","security_team","sellzone_virtual_team","seoquake_team","sky_team","snow_team","solar_team","sre_team","system_admins_team","tiger_team","tip_team","tomato_team","ui_kit_team","white_team","wire_team","yellow_team"],type:"choice"},shipping:{type:"number"},shipping_tier:{check_format:!0,max_length:100,min_length:1,type:"string"},state:{check_format:!0,max_length:100,min_length:1,type:"string"},status:{check_format:!0,max_length:100,min_length:1,type:"string"},subscription_type:{choice_values:["api_access","app_center_access","business","free","guru","pro"],type:"choice"},tax:{type:"number"},traffic_type:{choice_values:["external","internal"],type:"choice"},transaction_id:{check_format:!0,max_length:100,min_length:1,type:"string"},type:{check_format:!0,max_length:100,min_length:1,type:"string"},user_id:{max_length:100,min_length:1,type:"string"},user_type:{choice_values:["admin_free","admin_paid","free","paid","promo","trial","unlogged"],type:"choice"},value:{type:"number"},video_current_time:{type:"number"},video_duration:{type:"number"},video_percent:{type:"number"},video_provider:{check_format:!0,max_length:100,min_length:1,type:"string"},video_title:{check_format:!0,max_length:100,min_length:1,type:"string"},video_url:{check_format:!0,max_length:100,min_length:1,type:"string"},virtual_currency_name:{check_format:!0,max_length:100,min_length:1,type:"string"},visible:{type:"boolean"}}};function A(){let a=Symbol.for("ajst.js.alreadyLoaded");if(window[a])throw new _("ajst.js is already loaded, and it should not be loaded twice");let e=window.pendingAnalytics;if(!v(e))throw new _('ajst.js was not initialized properly. "pendingAnalytics" is missing or not an array');let t="dataLayer";w(t);let r=new g({validationRules:P}),n=r.facade;window.analytics=n,window[a]=!0,window.pendingAnalytics=void 0,r.pushInternalEvent({"ajst.js.start":new Date().getTime()}),j(n,e),r.pushInternalEvent({"ajst.js.pending_calls_processed":new Date().getTime()});let i=window.ANALYTICS_GTM_ID;typeof i=="string"?(E(i,t),r.pushInternalEvent({"ajst.js.gtm_injected":new Date().getTime()})):(r.pushInternalEvent({"ajst.js.without_gtm":!0}),console.warn('ajst.js: "ANALYTICS_GTM_ID" is missing or in the wrong format. Continuing without GTM.'))}A();})();
